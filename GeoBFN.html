<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="description"
        content="GeoBFN: Unified Generative Modeling of 3D MOLECULES Molecules via Bayesian Flow Networks" />
    <meta name="keywords, Drug Design, Molecule Generation, Deep Learning, Computational Biology"
        content="GeoBFN" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>GeoBFN: Unified Generative Modeling of 3D MOLECULES Molecules via Bayesian Flow Networks</title>

    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet" />
    <link rel="stylesheet" href="./css/bulma.min.css" />
    <link rel="stylesheet" href="./css/bulma-carousel.min.css" />
    <link rel="stylesheet" href="./css/bulma-slider.min.css" />
    <link rel="stylesheet" href="./css/fontawesome.all.min.css" />
    <!-- <link rel="stylesheet" href="./css/fontawesome_6_7_2.all.css" /> -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css" />
    <link rel="stylesheet" href="./css/index.css" />
    <link rel="stylesheet" href="./css/enhanced-styles.css" />
    <link rel="stylesheet" href="./css/final-enhancements.css" />
    <link rel="stylesheet" href="./css/navbar-fix.css" />
    <link rel="stylesheet" href="./css/navbar-alignment-fix.css" />
    <link rel="stylesheet" href="./css/overlap-fix.css" />
    <link rel="stylesheet" href="./css/spacing-fix.css" />
    <link rel="stylesheet" href="./css/author-affiliation-styles.css" />
    <link rel="icon" href="./assets/gensi_logo_black_topdown.png" type="image/png" />
    <!-- add page icon at 64 x 64-->
    <!-- <link rel="icon" type="image/png" href="./assets/re.png" sizes="256x256" /> -->

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script defer src="./js/fontawesome.all.min.js"></script>
    <script src="./js/bulma-carousel.min.js"></script>
    <script src="./js/bulma-slider.min.js"></script>
    <script src="./js/index.js"></script>
    <script src="./js/enhanced-animations.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        .menu {
          position: fixed;
          top: 20rem;
          left: 8rem;
          width: 10rem;
        }
        .main-content {
          margin-left: 10rem;
          padding-top: 20rem;
        }
    </style>
</head>


    



<body>

    <section class="hero">
        <div class="hero-body">
            <div class="container">
                <div class="has-text-centered">
                    <h1 class="publication-title">
                        <em class="dnerf">GeoBFN</em>: Unified Generative Modeling of 3D Molecules via Bayesian Flow Networks
                    </h1>
                    <div class="publication-authors">
                        <span class="author-block"><a href="songyuxuan@air.tsinghua.edu">Yuxuan Song</a><sup>1,‚Ä†</sup></span>
                        <span class="author-block"><a href="gongjingjing@air.tsinghua.edu">Jingjing Gong</a><sup>1,‚Ä†</sup></span>
                        <span class="author-block"><a >Yanru Qu</a><sup>2</sup></span>
                        <span class="author-block"><a href="zhouhao@air.tsinghua.edu">Hao Zhou</a><sup>1,*</sup></span><br>
                        <span class="author-block"><a >Mingyue Zheng</a><sup>3</sup></span>
                        <span class="author-block"><a >Jingjing Liu</a><sup>1</sup></span>
                        <span class="author-block"><a href="maweiying@air.tsinghua.edu">Wei-Ying Ma</a><sup>1</sup></span>
                    </div>
                    <div class="publication-affiliations">
                        <span class="affiliation-block"><sup>1</sup>Institute of AI Industry Research (AIR), Tsinghua University</span><br>
                        <span class="affiliation-block"><sup>2</sup>University of Illinois Urbana-Champaign</span>
                        <span class="affiliation-block"><sup>3</sup>Shanghai Institute of Materia Medica, Chinese Academy of Sciences</span><br>
                        <div class="affiliation-note">‚Ä†Equal Contribution</div>
                        <div class="affiliation-note">Contact: <a href="zhouhao@air.tsinghua.edu">zhouhao@air.tsinghua.edu</a></div>
                    </div>
                    <div class="publication-links">
                        <span class="link-block">
                            <a href="https://arxiv.org/pdf/2403.15441" class="external-link button is-dark">
                                <span class="icon">
                                    <i class="fas fa-file-pdf"></i>
                                </span>
                                <span>Paper</span>
                            </a>
                        </span>
                        <span class="link-block">
                            <a href="https://github.com/AlgoMole/GeoBFN" class="external-link button is-dark">
                                <span class="icon">
                                    <i class="fas fa-database"></i>
                                </span>
                                <span>Code</span>
                            </a>
                        </span>
                        <!-- <span class="link-block">
                            <a href="https://huggingface.co/BytedTsinghua-SIA/Enigmata-Qwen2.5-32B" class="external-link button is-dark">
                                <span class="icon">
                                    ü§ó
                                </span>
                                <span>Model</span>
                            </a>
                        </span> -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Sidebar -->
    <aside class="menu" >
        <p class="menu-label">GeoBFN</p>
        <ul class="menu-list">
            <li><a href="#introduction">Introduction</a></li>
            <li><a href="#eval">Evaluation</a></li>
            <li><a href="#model">Model</a></li>
            <li><a href="#citation">Citation</a></li>
        </ul>
    </aside>

    
    

    
    <div class="container">
        
        <!-- Main content -->

        

        
        <nav class="navbar is-fixed-top" role="navigation" aria-label="section navigation">
            <div class="container">
                <div class="navbar-brand">
                    <!-- <link rel="icon" href="./assets/gensi_logo_black_topdown.png" type="image/png" /> -->
                    <img src="./assets/gensi_new_logo.png"/>
                    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                    </a>
                </div>
                <div class="navbar-menu">
                    <div class="navbar-end">
                        <a class="navbar-item" href="index.html">Home</a>
                        <a class="navbar-item" href="GeoBFN.html">GeoBFN</a>
                        <a class="navbar-item" href="MolCRAFT-Series.html">MolCRAFT-Series</a>
                        <a class="navbar-item" href="CrysBFN.html">CrysBFN</a>
                        <a class="navbar-item" href="ProfileBFN.html">ProfileBFN</a>
                        <a class="navbar-item" href="GraphBFN.html">GraphBFN</a>
                        <a class="navbar-item" href="Others.html">Others</a>
                    </div>
                </div>
            </div>
        </nav>


        
            <section class="section project-section" id="introduction">
                <div class="container is-max-desktop"> 
                    <h2 class="title is-3">Introduction</h2>
                <div class="columns is-centered">
                    <div class="column">
                    <div class="content">
                        <img src="./assets/GeoBFN/geobfn_framework.png">
                        <p>
                        <strong>GeoBFN architecture</strong> 
                        </p>
                    </div>
                    </div>
            
                    <div class="column">
                    <div class="content">
                        <p>
                            In this work, we propose <strong>Geometric Bayesian Flow Networks (GeoBFN)</strong> to model 3D molecule
                            geometry in a principally different way. Bayesian Flow Networks Graves et al. (2023) (BFN) is
                            a novel generative model developed quite recently. Taking a unique approach by incorporating
                            Bayesian inference to modify the parameters of a collection of independent distributions, brings a
                            fresh perspective to geometric generative modeling. Firstly, <strong>GeoBFN</strong> uses a unified probabilistic
                            modeling formulation for different modalities in the molecule geometry. Secondly, regarding the
                            variable of 3D atom coordinates, the input variance for BFNs is considerably lower than DMs,
                            leading to better compatibility with the inherent noise sensitivity. Further, we bring the geometry
                            symmetries into the Bayesian update procedure through an equivariant inter-dependency modeling
                            module. We also demonstrate that the density function of implied generative distribution is SE-(3)
                            invariant and the generative process of iterative updating is roto-translational equivariant. Thirdly,
                            with BFN‚Äôs powerful probabilistic modeling capacity, 3D molecule geometry representation can
                            be further optimized into a representation with only two similar modalities: discretised charge and
                            continuous atom coordinates. The mode-redundancy issue on discretised variable in the original
                            BFNs is fixed by an early mode-seeking sampling strategy in <strong>GeoBFN</strong>
                        </p>
                        </div>
                    </div>
                </div>
                </div>
            </section>

            <section class="section" id="introduction">
                <div class="container">
        
                    <div class="columns is-centered">
                        <div class="column is-10">
                            <h2 class="title is-3">Introduction</h2>
                            <div class="content">
                                <p>
                                    In this work, we propose <strong>Geometric Bayesian Flow Networks (GeoBFN)</strong> to model 3D molecule
                                    geometry in a principally different way. Bayesian Flow Networks Graves et al. (2023) (BFN) is
                                    a novel generative model developed quite recently. Taking a unique approach by incorporating
                                    Bayesian inference to modify the parameters of a collection of independent distributions, brings a
                                    fresh perspective to geometric generative modeling. Firstly, <strong>GeoBFN</strong> uses a unified probabilistic
                                    modeling formulation for different modalities in the molecule geometry. Secondly, regarding the
                                    variable of 3D atom coordinates, the input variance for BFNs is considerably lower than DMs,
                                    leading to better compatibility with the inherent noise sensitivity. Further, we bring the geometry
                                    symmetries into the Bayesian update procedure through an equivariant inter-dependency modeling
                                    module. We also demonstrate that the density function of implied generative distribution is SE-(3)
                                    invariant and the generative process of iterative updating is roto-translational equivariant. Thirdly,
                                    with BFN‚Äôs powerful probabilistic modeling capacity, 3D molecule geometry representation can
                                    be further optimized into a representation with only two similar modalities: discretised charge and
                                    continuous atom coordinates. The mode-redundancy issue on discretised variable in the original
                                    BFNs is fixed by an early mode-seeking sampling strategy in <strong>GeoBFN</strong>
                                </p>
                            
                                
                                    <!-- <strong><em style="color: #3a76ed"><center>We hope Enigmata serves as a solid foundation for the community to push forth the research on reasoning models!</center></em></strong> -->
                                <!-- <p>
                                    Our key contributions are:
                                    <ul>
                                        <li>We introduce Enigmata, the first suite for enabling LLMs with advanced and comprehensive logical reasoning abilities for solving puzzles.</li>
                                        <li>The Enigmata suite consists of Enigmata-Data, featuring <strong>36 distinct tasks across 7 categories</strong> with
                                            controllable difficulty, scalable generation, and automatic verification, which seamlessly fit the RLVR
                                            training paradigm.</li>
                                        <li>We establish Enigmata-Eval, a benchmark that rigorously and comprehensively evaluates puzzle
                                            reasoning abilities, and propose the Enigmata-Model recipe that trains models with superior performance
                                            on in-domain and OOD puzzle reasoning tasks.</li>
                                        </ul> -->
        
                            </div>
                        </div>
                    </div>
        
                </div>
            </section>


          


            <section class="section" id="eval">
                <div class="container">
                    <div class="columns is-centered">
                        <div class="column is-10">
                            <h2 class="title is-3">‚öñÔ∏è Enigmata-Eval: Evaluating Logical Reasoning Capabilities</h2>
                            <div class="content">
                                <p>Enigmata-Eval is a comprehensive benchmark containing 4,758 puzzle instances across Easy, Medium, and Hard difficulty levels. Each task provides 50 instances per difficulty level where possible, with strict train-eval separation to prevent data leakage.</p>
        
                                <p>üì• <strong>Download Enigmata-Eval</strong>: <a href="https://huggingface.co/datasets/BytedTsinghua-SIA/Enigmata-Eval">HuggingFace Dataset</a></p>
                            
                 
        
                        
                        
                        
                        </div>
                    </div>
                </div>
            </section>
        
            
            <section class="section" id="model">
                <div class="container">
                    <div class="columns is-centered">
                        <div class="column is-10">
                            <h2 class="title is-3">ü§ñ Enigmata-Model: The Training Recipe</h2>
                            <div class="content">
                                <p>Our training methodology follows a two-stage process designed to systematically build reasoning abilities: 
                                    (1) rejection fine-tuning to establish foundational reasoning patterns, and 
                                    (2) multi-task RL to develop general reasoning skills that transfer across diverse problem domains.</p>
                            </div>
                            <div class="content">
                                <div
                                style="background-color: #f8fafc; border-radius: 12px; border-left: 6px solid #3a76ed; padding: 1.2rem; margin-bottom: 1.5rem;">
                                    <div style="display: flex; flex-direction: column; gap: 0.8rem;">
                                        <div style="display: flex; align-items: flex-start; gap: 0.8rem;"> 
                                            <div
                                                style="background-color: #3a76ed; color: white; padding: 0.4rem; border-radius: 50%; font-size: 0.9rem; display: flex; align-items: center; justify-content: center; min-width: 2rem; height: 2rem;">
                                                1
                                            </div>
                                            <div>
                                                <p style="margin: 0; line-height: 1.4;"><strong>Rejection Fine-tuning:</strong>
                                                    This initial stage focuses on building foundational reasoning by fine-tuning the model with high-quality solutions from a balanced mix of math and puzzle problems, including ARC-AGI.</p>
                                            </div>
                                        </div>
                                
                                        <div style="display: flex; align-items: flex-start; gap: 0.8rem;">
                                            <div
                                                style="background-color: #3a76ed; color: white; padding: 0.4rem; border-radius: 50%; font-size: 0.9rem; display: flex; align-items: center; justify-content: center; min-width: 2rem; height: 2rem;">
                                                2
                                            </div>
                                            <div>
                                            <p style="margin: 0; line-height: 1.4;"><strong>RL with Verifiable Puzzles:</strong> The model then undergoes reinforcement learning using VC-PPO, where an automated verifier for puzzles provides immediate rewards, enabling an automatic RL pipeline for puzzle reasoning.</p>
                                            </div>
                                        </div>
        
                                        <div style="display: flex; align-items: flex-start; gap: 0.8rem;">
                                            <div
                                                style="background-color: #3a76ed; color: white; padding: 0.4rem; border-radius: 50%; font-size: 0.9rem; display: flex; align-items: center; justify-content: center; min-width: 2rem; height: 2rem;">
                                                3
                                            </div>
                                            <div>
                                                <p style="margin: 0; line-height: 1.4;"><strong>Multi-task Training:</strong> To develop general and transferable logical reasoning, the training incorporates multi-task methods like Mix-training RL and Multi-stage RL, combining diverse puzzle types (Enigmata, ARC-AGI) with challenging mathematical problems (AIME) while maintaining a balanced ratio.</p>
                                            </div>
                                        </div>                                
                                </div>
                            </div>
                            </div>
        
                            
                            <div class="content">
                                <h4>üëÄ Experimental Results</h4>
                                <div class="content">
                                    <p>Our model, specifically the 32B parameter version, significantly outperforms most public models on Enigmata-Eval and ARC-AGI, showcasing enhanced general logical reasoning. This success stems from effective rejection fine-tuning (RFT) and multi-task RL strategies, which improve generalization while preserving existing math reasoning abilities.</p>
                                </div>
                                <figure>
                                    <img src="./assets/main_results_1.png" alt="A descriptive alt text for your image" style="width: 600px;">
                                    <figcaption style="color: gray;">Performance of reasoning, generic, and our trained LLMs on reasoning benchmarks</figcaption>
                                  </figure>
                                
                                  <div class="content">
                                    <p>On Enigmata-Eval, our Qwen2.5-32B-Enigmata model excels in Crypto, Arithmetic, and Logic tasks, indicating strong rule-based reasoning. It also performs competitively in search tasks, though spatial and sequential categories remain challenging.</p>
                                </div>
        
                                  <figure>
                                    <img src="./assets/main_results2.png" alt="A descriptive alt text for your image" style="width: 600px;">
                                    <figcaption style="color: gray;">Performance of reasoning LLMs, generic LLMs, and our trained LLMs on Enigmata-Eval</figcaption>
                                  </figure>
        
                            </div>
        
                            
                            <div class="content">
                                <h4>üåü Generalization with Scaling: Free Lunch from Enigmata </h4>
                            <div class="content">
                                <p>Incorporating the <strong>Enigmata-Data</strong> synthetic puzzle dataset into large-scale model training, e.g., <a href="https://arxiv.org/abs/2504.13914">Seed1.5-Thinking</a>, surprisingly improving performance on challenging benchmarks like AIME and GPQA Diamond. This demonstrates an unexpected <strong>generalization benefit</strong> for advanced reasoning models.</p>
                            </div>
        
                              <figure>
                                <img src="./assets/seed_thinking.png" alt="A descriptive alt text for your image" style="width: 600px;">
                                <figcaption style="color: gray;">Results on benchmarks for general reasoning capabilities</figcaption>
                              </figure>
                            </div>
                        </div>
                    </div>
                </div>
            </section>


            <section class="section" id="citation">
                <div class="container">
                    <div class="columns is-centered">
                        <div class="column is-10">
                            <h2 class="title is-3">üìù Citation</h2>
                            <div class="content">
                                <p>If you find this work useful, please cite our paper:</p>
                                <pre><code class="latex">
        @article{song2024unified,
            title={Unified Generative Modeling of 3D Molecules via Bayesian Flow Networks},
            author={Song, Yuxuan and Gong, Jingjing and Qu, Yanru and Zhou, Hao and Zheng, Mingyue and Liu, Jingjing and Ma, Wei-Ying},
            journal={arXiv preprint arXiv:2403.15441},
            year={2024}
        }
                                </code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
          
          <!-- ‚Ä¶ other sections ‚Ä¶ -->
        </div>
  </body>




</html>